package com.mafashen.jvm.gc;

import java.util.HashMap;
import java.util.Map;

public class TenuringTest {
	public static final int _1M = 1024 * 1024;
	public static final int _1K = 1024 ;
	public static void main(String[] args) {
		Map<Integer , byte[]> map = new HashMap<>();
		for (int i = 0; i < 5 * _1K; i++) {
			byte[] b = new byte[_1K];
			map.put(i , b);
		}

		for (int i = 0; i < 17; i++) {
			for (int j = 0; j < 270; j++) {
				byte[] b = new byte[_1M];
			}
		}
	}
/*
{Heap before GC invocations=0 (full 0):
 def new generation   total 314560K, used 278926K [0x00000007bae00000, 0x00000007d0350000, 0x00000007d0350000)
 eden区间不足触发YoungGC
  eden space 279616K,  99% used [0x00000007bae00000, 0x00000007cbe638c8, 0x00000007cbf10000)
  from space 34944K,   0% used [0x00000007cbf10000, 0x00000007cbf10000, 0x00000007ce130000)
  to   space 34944K,   0% used [0x00000007ce130000, 0x00000007ce130000, 0x00000007d0350000)
 tenured generation   total 699072K, used 0K [0x00000007d0350000, 0x00000007fae00000, 0x00000007fae00000)
   the space 699072K,   0% used [0x00000007d0350000, 0x00000007d0350000, 0x00000007d0350200, 0x00000007fae00000)
 compacting perm gen  total 21248K, used 2629K [0x00000007fae00000, 0x00000007fc2c0000, 0x0000000800000000)
   the space 21248K,  12% used [0x00000007fae00000, 0x00000007fb091530, 0x00000007fb091600, 0x00000007fc2c0000)
No shared spaces configured.
[GC[DefNew: 278926K->5818K(314560K), 0.0092560 secs] 278926K->5818K(1013632K), 0.0092800 secs] [Times: user=0.01 sys=0.00, real=0.00 secs]
Heap after GC invocations=1 (full 0):
 def new generation   total 314560K, used 5818K [0x00000007bae00000, 0x00000007d0350000, 0x00000007d0350000)
 GC后,eden区间被清空,存活对象移至from区
  eden space 279616K,   0% used [0x00000007bae00000, 0x00000007bae00000, 0x00000007cbf10000)
  from space 34944K,  16% used [0x00000007ce130000, 0x00000007ce6de928, 0x00000007d0350000)
  to   space 34944K,   0% used [0x00000007cbf10000, 0x00000007cbf10000, 0x00000007ce130000)
 tenured generation   total 699072K, used 0K [0x00000007d0350000, 0x00000007fae00000, 0x00000007fae00000)
   the space 699072K,   0% used [0x00000007d0350000, 0x00000007d0350000, 0x00000007d0350200, 0x00000007fae00000)
 compacting perm gen  total 21248K, used 2629K [0x00000007fae00000, 0x00000007fc2c0000, 0x0000000800000000)
   the space 21248K,  12% used [0x00000007fae00000, 0x00000007fb091530, 0x00000007fb091600, 0x00000007fc2c0000)
No shared spaces configured.
}
 */
/*
{Heap before GC invocations=15 (full 0):
 def new generation   total 314560K, used 285381K [0x00000007bae00000, 0x00000007d0350000, 0x00000007d0350000)
  eden space 279616K,  99% used [0x00000007bae00000, 0x00000007cbf05200, 0x00000007cbf10000)
  from space 34944K,  16% used [0x00000007ce130000, 0x00000007ce6dc5a8, 0x00000007d0350000)
  to   space 34944K,   0% used [0x00000007cbf10000, 0x00000007cbf10000, 0x00000007ce130000)
 tenured generation   total 699072K, used 0K [0x00000007d0350000, 0x00000007fae00000, 0x00000007fae00000)
   the space 699072K,   0% used [0x00000007d0350000, 0x00000007d0350000, 0x00000007d0350200, 0x00000007fae00000)
 compacting perm gen  total 21248K, used 2629K [0x00000007fae00000, 0x00000007fc2c0000, 0x0000000800000000)
   the space 21248K,  12% used [0x00000007fae00000, 0x00000007fb091530, 0x00000007fb091600, 0x00000007fc2c0000)
No shared spaces configured.
[GC[DefNew: 285381K->0K(314560K), 0.0146280 secs] 285381K->5809K(1013632K), 0.0146580 secs] [Times: user=0.01 sys=0.00, real=0.01 secs]
Heap after GC invocations=16 (full 0):
 def new generation   total 314560K, used 0K [0x00000007bae00000, 0x00000007d0350000, 0x00000007d0350000)
  eden space 279616K,   0% used [0x00000007bae00000, 0x00000007bae00000, 0x00000007cbf10000)
  存活对象到达一定年龄,自动晋升老年代
  from space 34944K,   0% used [0x00000007cbf10000, 0x00000007cbf10088, 0x00000007ce130000)
  to   space 34944K,   0% used [0x00000007ce130000, 0x00000007ce130000, 0x00000007d0350000)
 tenured generation   total 699072K, used 5809K [0x00000007d0350000, 0x00000007fae00000, 0x00000007fae00000)
   the space 699072K,   0% used [0x00000007d0350000, 0x00000007d08fc520, 0x00000007d08fc600, 0x00000007fae00000)
 compacting perm gen  total 21248K, used 2629K [0x00000007fae00000, 0x00000007fc2c0000, 0x0000000800000000)
   the space 21248K,  12% used [0x00000007fae00000, 0x00000007fb091530, 0x00000007fb091600, 0x00000007fc2c0000)
No shared spaces configured.
}
 */
/*	晋升年龄动态判断
{Heap before GC invocations=0 (full 0):
 def new generation   total 314560K, used 278926K [0x00000007bae00000, 0x00000007d0350000, 0x00000007d0350000)
  eden space 279616K,  99% used [0x00000007bae00000, 0x00000007cbe638c8, 0x00000007cbf10000)
  from space 34944K,   0% used [0x00000007cbf10000, 0x00000007cbf10000, 0x00000007ce130000)
  to   space 34944K,   0% used [0x00000007ce130000, 0x00000007ce130000, 0x00000007d0350000)
 tenured generation   total 699072K, used 0K [0x00000007d0350000, 0x00000007fae00000, 0x00000007fae00000)
   the space 699072K,   0% used [0x00000007d0350000, 0x00000007d0350000, 0x00000007d0350200, 0x00000007fae00000)
 compacting perm gen  total 21248K, used 2629K [0x00000007fae00000, 0x00000007fc2c0000, 0x0000000800000000)
   the space 21248K,  12% used [0x00000007fae00000, 0x00000007fb091530, 0x00000007fb091600, 0x00000007fc2c0000)
No shared spaces configured.
[GC[DefNew: 278926K->5818K(314560K), 0.0094950 secs] 278926K->5818K(1013632K), 0.0095240 secs] [Times: user=0.01 sys=0.00, real=0.01 secs]
Heap after GC invocations=1 (full 0):
 def new generation   total 314560K, used 5818K [0x00000007bae00000, 0x00000007d0350000, 0x00000007d0350000)
  eden space 279616K,   0% used [0x00000007bae00000, 0x00000007bae00000, 0x00000007cbf10000)
  from space 34944K,  16% used [0x00000007ce130000, 0x00000007ce6de928, 0x00000007d0350000)
  to   space 34944K,   0% used [0x00000007cbf10000, 0x00000007cbf10000, 0x00000007ce130000)
 tenured generation   total 699072K, used 0K [0x00000007d0350000, 0x00000007fae00000, 0x00000007fae00000)
   the space 699072K,   0% used [0x00000007d0350000, 0x00000007d0350000, 0x00000007d0350200, 0x00000007fae00000)
 compacting perm gen  total 21248K, used 2629K [0x00000007fae00000, 0x00000007fc2c0000, 0x0000000800000000)
   the space 21248K,  12% used [0x00000007fae00000, 0x00000007fb091530, 0x00000007fb091600, 0x00000007fc2c0000)
No shared spaces configured.
}
{Heap before GC invocations=1 (full 0):
 def new generation   total 314560K, used 284991K [0x00000007bae00000, 0x00000007d0350000, 0x00000007d0350000)
  eden space 279616K,  99% used [0x00000007bae00000, 0x00000007cbea1308, 0x00000007cbf10000)
  相同年龄对象总大小达到TargetSurvivorRatio,晋升年龄判断为更小的此对象年龄
  from space 34944K,  16% used [0x00000007ce130000, 0x00000007ce6de928, 0x00000007d0350000)
  to   space 34944K,   0% used [0x00000007cbf10000, 0x00000007cbf10000, 0x00000007ce130000)
 tenured generation   total 699072K, used 0K [0x00000007d0350000, 0x00000007fae00000, 0x00000007fae00000)
   the space 699072K,   0% used [0x00000007d0350000, 0x00000007d0350000, 0x00000007d0350200, 0x00000007fae00000)
 compacting perm gen  total 21248K, used 2629K [0x00000007fae00000, 0x00000007fc2c0000, 0x0000000800000000)
   the space 21248K,  12% used [0x00000007fae00000, 0x00000007fb091530, 0x00000007fb091600, 0x00000007fc2c0000)
No shared spaces configured.
[GC[DefNew: 284991K->0K(314560K), 0.0068190 secs] 284991K->5809K(1013632K), 0.0068370 secs] [Times: user=0.01 sys=0.01, real=0.00 secs]
Heap after GC invocations=2 (full 0):
 def new generation   total 314560K, used 0K [0x00000007bae00000, 0x00000007d0350000, 0x00000007d0350000)
  eden space 279616K,   0% used [0x00000007bae00000, 0x00000007bae00000, 0x00000007cbf10000)
  from space 34944K,   0% used [0x00000007cbf10000, 0x00000007cbf10088, 0x00000007ce130000)
  to   space 34944K,   0% used [0x00000007ce130000, 0x00000007ce130000, 0x00000007d0350000)
 tenured generation   total 699072K, used 5809K [0x00000007d0350000, 0x00000007fae00000, 0x00000007fae00000)
   the space 699072K,   0% used [0x00000007d0350000, 0x00000007d08fc5e8, 0x00000007d08fc600, 0x00000007fae00000)
 compacting perm gen  total 21248K, used 2629K [0x00000007fae00000, 0x00000007fc2c0000, 0x0000000800000000)
   the space 21248K,  12% used [0x00000007fae00000, 0x00000007fb091530, 0x00000007fb091600, 0x00000007fc2c0000)
No shared spaces configured.
}
 */
}
